<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Empleos</title>
    <!-- Fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Estilos CSS -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/utilities.css">

    <!-- Componentes CSS -->
    <link rel="stylesheet" href="css/components/header.css">
    <link rel="stylesheet" href="css/components/filters.css">
    <link rel="stylesheet" href="css/components/job-card.css">
    <link rel="stylesheet" href="css/components/job-detail.css">
    <link rel="stylesheet" href="css/components/modal.css">
    <style>

    </style>
</head>

<body>
    <div class="container">
        <div class="hero-content animate-fade-in">
            <h1>Encuentra tu próximo trabajo en el sector agroindustrial</h1>
            <p>Miles de oportunidades en las principales empresas agroexportadoras del Perú</p>

            <!-- Buscador Principal -->
            <div class="search-box">
                <form class="search-form" id="searchForm" action="/empleos/buscar" method="GET">
                    <div class="search-group">

                        <i class="fas fa-search search-icon"></i>


                        <input type="text" name="query" id="searchInput" class="search-input"
                            placeholder="Buscar empleos..." autocomplete="off" aria-label="Buscar empleos">
                    </div>

                    <div class="search-group">
                        <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                        <select name="location" id="locationSelect" class="search-select"
                            aria-label="Seleccionar ubicación">
                            <option value="">Todas las ubicaciones</option>
                            <option value="ICA">Ica</option>
                            <option value="CHINCHA">Chincha</option>
                            <option value="PISCO">Pisco</option>
                            <option value="LIMA">Lima</option>
                            <option value="TRUJILLO">Trujillo</option>
                        </select>
                    </div>

                    <button type="submit" class="button button-primary">
                        <i class="fas fa-search" aria-hidden="true"></i>
                        <span>Buscar Empleos</span>
                    </button>
                </form>
            </div>
        </div>
    </div>
    <!-- FILTROS -->
    <div class="filters-row">
        <div class="filter-pill">
            <button class="filter-button">
                Ordenar
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="filter-dropdown">
                <div class="dropdown-item">Más recientes</div>
                <div class="dropdown-item">Más relevantes</div>
                <div class="dropdown-item">Mayor salario</div>
            </div>
        </div>

        <div class="filter-pill">
            <button class="filter-button">
                Distancia
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="filter-dropdown">
                <div class="dropdown-item">Menos de 5 km</div>
                <div class="dropdown-item">5 - 10 km</div>
                <div class="dropdown-item">10 - 20 km</div>
                <div class="dropdown-item">Más de 20 km</div>
            </div>
        </div>

        <div class="filter-pill">
            <button class="filter-button">
                Fecha
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="filter-dropdown">
                <div class="dropdown-item">Hoy</div>
                <div class="dropdown-item">Últimos 3 días</div>
                <div class="dropdown-item">Última semana</div>
                <div class="dropdown-item">Último mes</div>
            </div>
        </div>

        <div class="filter-pill">
            <button class="filter-button">
                Categoría
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="filter-dropdown">
                <div class="dropdown-item">Ventas</div>
                <div class="dropdown-item">Tecnología</div>
                <div class="dropdown-item">Administración</div>
                <div class="dropdown-item">Marketing</div>
            </div>
        </div>

        <div class="filter-pill">
            <button class="filter-button">
                Lugar de trabajo
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="filter-dropdown">
                <div class="dropdown-item">Presencial</div>
                <div class="dropdown-item">Remoto</div>
                <div class="dropdown-item">Híbrido</div>
            </div>
        </div>

        <div class="filter-pill">
            <button class="filter-button">
                Experiencia
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="filter-dropdown">
                <div class="dropdown-item">Sin experiencia</div>
                <div class="dropdown-item">1-3 años</div>
                <div class="dropdown-item">3-5 años</div>
                <div class="dropdown-item">5+ años</div>
            </div>
        </div>

        <div class="filter-pill">
            <button class="filter-button">
                Salario
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="filter-dropdown">
                <div class="dropdown-item">Hasta S/1,500</div>
                <div class="dropdown-item">S/1,500 - S/3,000</div>
                <div class="dropdown-item">S/3,000 - S/5,000</div>
                <div class="dropdown-item">Más de S/5,000</div>
            </div>
        </div>

        <div class="filter-pill">
            <button class="filter-button">
                Jornada
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="filter-dropdown">
                <div class="dropdown-item">Tiempo completo</div>
                <div class="dropdown-item">Medio tiempo</div>
                <div class="dropdown-item">Por horas</div>
            </div>
        </div>

        <div class="filter-pill">
            <button class="filter-button">
                Contrato
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="filter-dropdown">
                <div class="dropdown-item">Indefinido</div>
                <div class="dropdown-item">Temporal</div>
                <div class="dropdown-item">Prácticas</div>
            </div>
        </div>

        <div class="filter-pill">
            <button class="filter-button">
                Discapacidad
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="filter-dropdown">
                <div class="dropdown-item">Sí</div>
                <div class="dropdown-item">No</div>
            </div>
        </div>
    </div>
    <div class="app-container">
        <!-- Lista de empleos (panel izquierdo) -->
        <div class="jobs-list-container">
            <div class="jobs-list-header">
                <h1 style="font-size: 1.25rem;">Empleos Disponibles</h1>
            </div>
            <div class="jobs-list" id="jobsList">
                <!-- Las cards de trabajo se insertarán aquí dinámicamente -->
            </div>
        </div>

        <!-- Detalle del empleo (panel derecho) -->
        <div class="job-detail-container" id="jobDetailContainer">
            <!-- El detalle del trabajo se insertará aquí dinámicamente -->
        </div>

        <!-- Modal para móviles -->
        <div class="modal" id="jobModal">
            <div class="modal-content">
                <button class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
                <div id="modalContent">
                    <!-- El contenido del modal se insertará aquí dinámicamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- Template para la card de trabajo -->
    <template id="jobCardTemplate">
        <article class="job-card">
            <!-- Header de la empresa -->
            <div class="job-header">
                <div class="company-logo" title="Agrícola Chapi">
                    <img src="https://scontent.flim2-1.fna.fbcdn.net/v/t39.30808-6/326764918_1955909824752287_8459968866846313747_n.png?_nc_cat=109&ccb=1-7&_nc_sid=6ee11a&_nc_ohc=e-RvlMuUp0IQ7kNvgEMz0nE&_nc_zt=23&_nc_ht=scontent.flim2-1.fna&_nc_gid=AdSRkH3zszhmyVat6CmcIDp&oh=00_AYD7YYI8oqz2b_mfEqO4YK0CzPkuubbR76x-B8fMYfEdzA&oe=672C4D4F" 
                         alt="Agrícola Chapi"
                         onerror="handleImageError(this, 'Agrícola Chapi')">
                </div>
                <div class="company-info">
                    <span class="company-name">
                        Agrícola Chapi
                        <i class="fas fa-check-circle verified-icon" title="Empresa Verificada"></i>
                    </span>
                    <div class="company-info-1">
                        <span class="company-evaluation" title="Evaluación de la empresa">
                            <i class="fas fa-star"></i>
                            4,3
                        </span>
                        <span class="location-badge">
                            <i class="fas fa-location-dot"></i>
                            Subtanjalla, Ica
                        </span>
                    </div>
                </div>
            </div>

            <!-- Badges -->
            <div class="badges-container">
                <div class="featured-badge">
                    <i class="fas fa-star"></i>
                    Destacado
                </div>
                <div class="urgency-tag">
                    <i class="fas fa-fire"></i>
                    <span>Se requiere con urgencia</span>
                </div>
            </div>

            <!-- Título -->
            <div class="title">
                <h1 class="job-title">Asesor de ventas con o sin experiencia / Turno Mañana Remoto / Home Office</h1>
            </div>

            <!-- Detalles -->
            <div class="job-details">
                <div class="detail-item" title="Salario mensual">
                    <i class="fas fa-money-bill-wave"></i>
                    <div>
                        <span class="salary-detail"></span>
                        <span class="salary-type">S/ 1.025,00 · Mensual</span>
                    </div>
                </div>
                <div class="jobs-details-row">
                    <div class="detail-item" title="Tipo de contrato">
                        <i class="fas fa-briefcase"></i>
                        <div>Jornal y destajo</div>
                    </div>
                    <div class="detail-item" title="Horario">
                        <i class="fas fa-clock"></i>
                        <div>Tiempo Completo</div>
                    </div>
                    <div class="detail-item" title="Duración">
                        <i class="fas fa-hourglass-half"></i>
                        <div>3 meses</div>
                    </div>
                    <div class="detail-item" title="Vacantes">
                        <i class="fas fa-users"></i>
                        <div>20 vacantes</div>
                    </div>
                </div>
                <div class="time-posted">
                    Publicado hace 17 horas
                </div>
            </div>
        </article>
    </template>

    <!-- Template para el detalle completo del trabajo -->
    <template id="jobDetailTemplate">
        <div class="full-job-details">
            <div class="job-detail-header">
                <div class="job-header">
                    <div class="company-logo">
                        <img src="" alt="" onerror="handleImageError(this, this.alt)">
                    </div>
                    <div class="company-info">
                        <h1 class="company-name">
                            <span class="company-name-text"></span>
                            <i class="fas fa-check-circle verified-icon" title="Empresa Verificada"></i>
                        </h1>
                        <div class="company-meta">
                            <span class="company-evaluation">
                                <i class="fas fa-star"></i>
                                <span class="rating"></span>
                            </span>
                            <span class="company-stat">
                                <i class="fas fa-users"></i>
                                <span class="employees"></span>
                            </span>
                            <span class="location-badge">
                                <i class="fas fa-location-dot"></i>
                                <span class="location"></span>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="badges-container">
                    <span class="badge badge-primary">
                        <i class="fas fa-star"></i>
                        Destacado
                    </span>
                    <span class="badge badge-urgent">
                        <i class="fas fa-fire"></i>
                        Se requiere con urgencia
                    </span>
                </div>

                <h2 class="job-title"></h2>

                <div class="job-meta">
                    <div class="detail-item">
                        <i class="fas fa-money-bill-wave"></i>
                        <div class="salary"></div>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-briefcase"></i>
                        <div class="contract-type"></div>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-clock"></i>
                        <div class="schedule"></div>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-calendar"></i>
                        <div class="duration"></div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i>
                        Postular ahora
                    </button>
                    <button class="btn btn-outline">
                        <i class="far fa-bookmark"></i>
                        Guardar empleo
                    </button>
                </div>
            </div>

            <div class="job-detail-content">
                <!-- Descripción -->
                <section class="content-section">
                    <h3 class="section-title">
                        <i class="fas fa-align-left"></i>
                        Descripción del puesto
                    </h3>
                    <div class="job-description"></div>
                </section>

                <!-- Requisitos -->
                <section class="content-section">
                    <h3 class="section-title">
                        <i class="fas fa-list-check"></i>
                        Requisitos
                    </h3>
                    <ul class="requirements-list"></ul>
                </section>

                <!-- Beneficios -->
                <section class="content-section">
                    <h3 class="section-title">
                        <i class="fas fa-gift"></i>
                        Beneficios
                    </h3>
                    <ul class="benefits-list"></ul>
                </section>
            </div>
        </div>
    </template>

    <script>
        // Estado global y configuración
        let currentActiveCard = null;
        let filteredJobs = [];
        let selectedFilters = {};

        const config = {
            itemsPerPage: 10,
            currentPage: 1,
            sortBy: 'recent',
        };

        // Datos de ejemplo
        const jobsData = [
            {
                id: 1,
                company: {
                    name: "Agrícola Los Medanos",
                    logo: "https://scontent.flim2-1.fna.fbcdn.net/v/t39.30808-6/326764918_1955909824752287_8459968866846313747_n.png",
                    rating: "4,3",
                    employees: "500+",
                    location: "Subtanjalla, Ica",
                    verified: true,
                    category: "Ventas"
                },
                title: "Asesor de ventas con o sin experiencia / Turno Mañana Remoto / Home Office",
                salary: "S/ 1.025,00",
                salaryNum: 1025,
                contractType: "Jornal y destajo",
                schedule: "Tiempo Completo",
                duration: "3 meses",
                experience: "Sin experiencia",
                workLocation: "Remoto",
                date: new Date('2024-02-01'),
                description: "Nos encontramos en búsqueda de los mejores talentos para unirse a nuestro equipo de ventas...",
                requirements: [
                    "Experiencia mínima de 1 año en ventas (deseable)",
                    "Estudios técnicos o universitarios (en curso o concluidos)",
                    "Manejo de herramientas office a nivel usuario",
                    "Disponibilidad para trabajo remoto"
                ],
                benefits: [
                    "Sueldo base + comisiones sin tope",
                    "Capacitación constante",
                    "Desarrollo de línea de carrera",
                    "Seguro de salud desde el primer día"
                ],
                featured: true,
                urgent: true,
                distance: 2
            },
            {
                id: 2,
                company: {
                    name: "Agrícola Chapi",
                    logo: "path/to/logo.png",
                    rating: "4,5",
                    employees: "1000+",
                    location: "Chincha, Ica",
                    verified: true,
                    category: "Administración"
                },
                title: "Asistente Administrativo",
                salary: "S/ 2.500,00",
                salaryNum: 2500,
                contractType: "Indefinido",
                schedule: "Tiempo Completo",
                duration: "Indefinido",
                experience: "1-3 años",
                workLocation: "Presencial",
                date: new Date('2024-02-15'),
                description: "Importante empresa agrícola busca incorporar un Asistente Administrativo...",
                requirements: [
                    "Experiencia mínima de 2 años en posiciones similares",
                    "Bachiller en Administración o afines",
                    "Excel avanzado",
                    "Disponibilidad para trabajar en Chincha"
                ],
                benefits: [
                    "Sueldo competitivo",
                    "Beneficios de ley",
                    "Seguro EPS",
                    "Bonos por desempeño"
                ],
                featured: true,
                urgent: false,
                distance: 5
            }
            // Puedes agregar más trabajos aquí...
        ];

        // Función para crear el detalle de un trabajo
        function createJobCard(job) {
            const template = document.getElementById('jobCardTemplate');
            const card = template.content.cloneNode(true);

            // Logo y nombre de la empresa
            const logoImg = card.querySelector('.company-logo img');
            logoImg.src = job.company.logo;
            logoImg.alt = job.company.name;

            card.querySelector('.company-name-text').textContent = job.company.name;

            // Si no está verificada, ocultar el ícono de verificación
            if (!job.company.verified) {
                card.querySelector('.verified-icon').style.display = 'none';
            }

            // Rating y ubicación
            card.querySelector('.rating').textContent = job.company.rating;
            card.querySelector('.location').textContent = job.company.location;

            // Badges
            const badgesContainer = card.querySelector('.badges-container');
            if (!job.featured) {
                badgesContainer.querySelector('.badge-primary').style.display = 'none';
            }
            if (!job.urgent) {
                badgesContainer.querySelector('.badge-urgent').style.display = 'none';
            }

            // Título y detalles
            card.querySelector('.job-title').textContent = job.title;
            card.querySelector('.salary').textContent = job.salary;
            card.querySelector('.contract-type').textContent = job.contractType;

            // Configurar la card completa
            const jobCard = card.querySelector('.job-card');
            jobCard.setAttribute('data-job-id', job.id);

            return jobCard;
        }

        function createJobDetail(job) {
            const template = document.getElementById('jobDetailTemplate');
            const detail = template.content.cloneNode(true);

            // Logo y nombre de la empresa
            const logoImg = detail.querySelector('.company-logo img');
            logoImg.src = job.company.logo;
            logoImg.alt = job.company.name;

            detail.querySelector('.company-name-text').textContent = job.company.name;

            if (!job.company.verified) {
                detail.querySelector('.verified-icon').style.display = 'none';
            }

            // Metadatos de la empresa
            detail.querySelector('.rating').textContent = job.company.rating;
            detail.querySelector('.employees').textContent = job.company.employees;
            detail.querySelector('.location').textContent = job.company.location;

            // Badges
            const badgesContainer = detail.querySelector('.badges-container');
            if (!job.featured) {
                badgesContainer.querySelector('.badge-primary').style.display = 'none';
            }
            if (!job.urgent) {
                badgesContainer.querySelector('.badge-urgent').style.display = 'none';
            }

            // Título y detalles del trabajo
            detail.querySelector('.job-title').textContent = job.title;
            detail.querySelector('.salary').textContent = job.salary;
            detail.querySelector('.contract-type').textContent = job.contractType;
            detail.querySelector('.schedule').textContent = job.schedule;
            detail.querySelector('.duration').textContent = job.duration;

            // Descripción del puesto
            detail.querySelector('.job-description').textContent = job.description;

            // Requisitos
            const requirementsList = detail.querySelector('.requirements-list');
            job.requirements.forEach(req => {
                const li = document.createElement('li');
                li.className = 'requirement-item';
                li.innerHTML = `<i class="fas fa-check"></i><span>${req}</span>`;
                requirementsList.appendChild(li);
            });

            // Beneficios
            const benefitsList = detail.querySelector('.benefits-list');
            job.benefits.forEach(benefit => {
                const li = document.createElement('li');
                li.className = 'benefit-item';
                li.innerHTML = `<i class="fas fa-check"></i><span>${benefit}</span>`;
                benefitsList.appendChild(li);
            });

            return detail;
        }


        // Inicialización
        document.addEventListener('DOMContentLoaded', () => {
            initializeApp();
        });

        function initializeApp() {
            setupEventListeners();
            setupFilters();
            setupSearch();
            loadInitialJobs();
            setupAccessibility();
            handleInitialJobDisplay();
        }

        // Configuración de event listeners principales
        function setupEventListeners() {
            const jobsList = document.getElementById('jobsList');
            const modal = document.getElementById('jobModal');
            const modalClose = document.getElementById('modalClose');
            const searchForm = document.getElementById('searchForm');

            // Event listeners principales
            searchForm.addEventListener('submit', handleSearchSubmit);
            modalClose.addEventListener('click', closeModal);
            window.addEventListener('resize', handleResize);
            document.addEventListener('keydown', handleKeyPress);
            modal.addEventListener('click', handleModalClick);
        }

        // Manejo de búsqueda y filtros
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            const locationSelect = document.getElementById('locationSelect');

            searchInput.addEventListener('input', debounce(handleSearch, 300));
            locationSelect.addEventListener('change', handleSearch);
        }

        function setupFilters() {
            document.querySelectorAll('.filter-button').forEach(button => {
                button.addEventListener('click', handleFilterClick);
            });

            document.querySelectorAll('.dropdown-item').forEach(item => {
                item.addEventListener('click', handleFilterSelection);
            });

            document.addEventListener('click', handleOutsideClick);
        }

        // Funciones de manejo de eventos
        function handleSearchSubmit(e) {
            e.preventDefault();
            handleSearch();
        }

        function handleSearch() {
            const searchInput = document.getElementById('searchInput');
            const locationSelect = document.getElementById('locationSelect');
            const query = searchInput.value.toLowerCase().trim();
            const location = locationSelect.value.toLowerCase();

            filteredJobs = jobsData.filter(job => {
                const matchQuery = !query ||
                    job.title.toLowerCase().includes(query) ||
                    job.company.name.toLowerCase().includes(query);

                const matchLocation = !location ||
                    job.company.location.toLowerCase().includes(location);

                return matchQuery && matchLocation && matchesFilters(job);
            });

            updateJobsList();
        }

        function handleFilterClick(e) {
            e.stopPropagation();
            const pill = this.closest('.filter-pill');

            document.querySelectorAll('.filter-pill.active').forEach(activePill => {
                if (activePill !== pill) {
                    activePill.classList.remove('active');
                }
            });

            pill.classList.toggle('active');
        }

        // Continuará en la siguiente parte...
        // Manejo de filtros
        function handleFilterSelection() {
            const pill = this.closest('.filter-pill');
            const filterType = pill.querySelector('.filter-button').textContent.trim();
            const filterValue = this.textContent.trim();

            // Actualizar estado del filtro
            selectedFilters[filterType] = filterValue;

            // Actualizar UI
            updateFilterUI(pill, this);

            // Aplicar filtros
            applyFilters();
        }

        function updateFilterUI(pill, selectedItem) {
            // Actualizar texto del botón
            const button = pill.querySelector('.filter-button');
            button.childNodes[0].textContent = selectedItem.textContent;

            // Actualizar estado visual
            pill.querySelectorAll('.dropdown-item').forEach(item => {
                item.classList.remove('selected');
            });
            selectedItem.classList.add('selected');

            // Cerrar dropdown
            pill.classList.remove('active');
        }

        function applyFilters() {
            filteredJobs = jobsData.filter(job => matchesFilters(job));
            updateJobsList();
            updateFilterTags();
        }

        function matchesFilters(job) {
            return Object.entries(selectedFilters).every(([type, value]) => {
                if (!value) return true;

                switch (type.toLowerCase()) {
                    case 'ordenar':
                        return true; // Manejado por sortJobs()
                    case 'distancia':
                        return matchesDistance(job, value);
                    case 'fecha':
                        return matchesDate(job, value);
                    case 'categoría':
                        return job.company.category === value;
                    case 'lugar de trabajo':
                        return job.workLocation === value;
                    case 'experiencia':
                        return job.experience === value;
                    case 'salario':
                        return matchesSalary(job, value);
                    case 'jornada':
                        return job.schedule.includes(value);
                    case 'contrato':
                        return job.contractType.includes(value);
                    default:
                        return true;
                }
            });
        }

        // Funciones auxiliares para filtros
        function matchesDistance(job, filterValue) {
            const distanceMap = {
                'Menos de 5 km': 5,
                '5 - 10 km': 10,
                '10 - 20 km': 20,
                'Más de 20 km': Infinity
            };

            const maxDistance = distanceMap[filterValue];
            return job.distance <= maxDistance;
        }

        function matchesDate(job, filterValue) {
            const now = new Date();
            const jobDate = new Date(job.date);
            const diffDays = Math.floor((now - jobDate) / (1000 * 60 * 60 * 24));

            switch (filterValue) {
                case 'Hoy':
                    return diffDays === 0;
                case 'Últimos 3 días':
                    return diffDays <= 3;
                case 'Última semana':
                    return diffDays <= 7;
                case 'Último mes':
                    return diffDays <= 30;
                default:
                    return true;
            }
        }

        function matchesSalary(job, filterValue) {
            const salary = job.salaryNum;
            const ranges = {
                'Hasta S/1,500': [0, 1500],
                'S/1,500 - S/3,000': [1500, 3000],
                'S/3,000 - S/5,000': [3000, 5000],
                'Más de S/5,000': [5000, Infinity]
            };

            const [min, max] = ranges[filterValue];
            return salary >= min && salary <= max;
        }

        // Actualización de UI
        function updateJobsList() {
            const jobsList = document.getElementById('jobsList');
            jobsList.innerHTML = '';

            if (filteredJobs.length === 0) {
                showNoResults();
                return;
            }

            // Ordenar trabajos según el filtro actual
            const sortedJobs = sortJobs(filteredJobs);

            // Aplicar paginación
            const startIndex = (config.currentPage - 1) * config.itemsPerPage;
            const paginatedJobs = sortedJobs.slice(startIndex, startIndex + config.itemsPerPage);

            paginatedJobs.forEach(job => {
                const jobCard = createJobCard(job);
                jobsList.appendChild(jobCard);

                jobCard.addEventListener('click', () => handleJobClick(job, jobCard));
            });

            updatePagination(sortedJobs.length);
        }

        function updateFilterTags() {
            const tagsContainer = document.getElementById('activeFilters');
            if (!tagsContainer) return;

            tagsContainer.innerHTML = '';

            Object.entries(selectedFilters).forEach(([type, value]) => {
                if (!value) return;

                const tag = createFilterTag(type, value);
                tagsContainer.appendChild(tag);
            });
        }

        function createFilterTag(type, value) {
            const tag = document.createElement('div');
            tag.className = 'filter-tag';
            tag.innerHTML = `
        ${value}
        <button onclick="removeFilter('${type}')" aria-label="Eliminar filtro ${value}">
            <i class="fas fa-times"></i>
        </button>
    `;
            return tag;
        }

        // Manejo de clicks y navegación
        function handleJobClick(job, jobCard) {
            if (currentActiveCard) {
                currentActiveCard.classList.remove('active');
            }
            currentActiveCard = jobCard;
            jobCard.classList.add('active');

            const jobDetail = createJobDetail(job);

            if (window.innerWidth <= 1024) {
                showModal(jobDetail);
            } else {
                updateJobDetail(jobDetail);
            }
        }

        function handleModalClick(e) {
            if (e.target === this) {
                closeModal();
            }
        }

        function handleKeyPress(e) {
            if (e.key === 'Escape') {
                closeModal();
                closeAllDropdowns();
            }
        }

        // Continuará en la siguiente parte...

        // Funciones de UI y Modal
        function showModal(content) {
            const modalContent = document.getElementById('modalContent');
            const modal = document.getElementById('jobModal');

            modalContent.innerHTML = '';
            modalContent.appendChild(content);
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            const modal = document.getElementById('jobModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function updateJobDetail(content) {
            const container = document.getElementById('jobDetailContainer');
            container.innerHTML = '';
            container.appendChild(content);
        }

        function showNoResults() {
            const jobsList = document.getElementById('jobsList');
            jobsList.innerHTML = `
        <div class="no-results">
            <i class="fas fa-search"></i>
            <h3>No se encontraron resultados</h3>
            <p>Intenta ajustar los filtros o usar otros términos de búsqueda</p>
        </div>
    `;
        }

        // Ordenamiento y Paginación
        function sortJobs(jobs) {
            const sortType = selectedFilters['Ordenar'];

            return [...jobs].sort((a, b) => {
                switch (sortType) {
                    case 'Más recientes':
                        return new Date(b.date) - new Date(a.date);
                    case 'Más relevantes':
                        return (b.featured ? 1 : 0) - (a.featured ? 1 : 0);
                    case 'Mayor salario':
                        return b.salaryNum - a.salaryNum;
                    default:
                        return new Date(b.date) - new Date(a.date);
                }
            });
        }

        function updatePagination(totalItems) {
            const totalPages = Math.ceil(totalItems / config.itemsPerPage);
            const paginationContainer = document.createElement('div');
            paginationContainer.className = 'pagination';

            // Botón anterior
            if (config.currentPage > 1) {
                const prevButton = createPaginationButton('Anterior', config.currentPage - 1);
                paginationContainer.appendChild(prevButton);
            }

            // Números de página
            for (let i = 1; i <= totalPages; i++) {
                if (
                    i === 1 ||
                    i === totalPages ||
                    (i >= config.currentPage - 2 && i <= config.currentPage + 2)
                ) {
                    const pageButton = createPaginationButton(i.toString(), i);
                    if (i === config.currentPage) {
                        pageButton.classList.add('active');
                    }
                    paginationContainer.appendChild(pageButton);
                } else if (
                    i === config.currentPage - 3 ||
                    i === config.currentPage + 3
                ) {
                    const dots = document.createElement('span');
                    dots.textContent = '...';
                    dots.className = 'pagination-dots';
                    paginationContainer.appendChild(dots);
                }
            }

            // Botón siguiente
            if (config.currentPage < totalPages) {
                const nextButton = createPaginationButton('Siguiente', config.currentPage + 1);
                paginationContainer.appendChild(nextButton);
            }

            // Agregar paginación al DOM
            const existingPagination = document.querySelector('.pagination');
            if (existingPagination) {
                existingPagination.replaceWith(paginationContainer);
            } else {
                document.getElementById('jobsList').appendChild(paginationContainer);
            }
        }

        function createPaginationButton(text, page) {
            const button = document.createElement('button');
            button.className = 'pagination-button';
            button.textContent = text;
            button.addEventListener('click', () => {
                config.currentPage = page;
                updateJobsList();
            });
            return button;
        }

        // Funciones auxiliares
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function handleResize() {
            if (window.innerWidth > 1024) {
                closeModal();
                if (currentActiveCard && filteredJobs.length > 0) {
                    const jobId = currentActiveCard.getAttribute('data-job-id');
                    const job = filteredJobs.find(j => j.id.toString() === jobId);
                    if (job) {
                        const jobDetail = createJobDetail(job);
                        updateJobDetail(jobDetail);
                    }
                }
            }
        }

        // Funciones de accesibilidad
        function setupAccessibility() {
            setupAriaLabels();
            setupKeyboardNavigation();
        }

        function setupAriaLabels() {
            document.querySelectorAll('.filter-button').forEach(button => {
                button.setAttribute('role', 'button');
                button.setAttribute('aria-haspopup', 'true');
                button.setAttribute('aria-expanded', 'false');
            });
        }

        function setupKeyboardNavigation() {
            document.querySelectorAll('.filter-pill').forEach(pill => {
                const button = pill.querySelector('.filter-button');
                const items = pill.querySelectorAll('.dropdown-item');

                button.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        pill.classList.toggle('active');
                        button.setAttribute('aria-expanded', pill.classList.contains('active'));
                    }
                });

                items.forEach(item => {
                    item.setAttribute('role', 'option');
                    item.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            item.click();
                        }
                    });
                });
            });
        }

        // Inicialización y carga inicial
        function loadInitialJobs() {
            filteredJobs = [...jobsData];
            updateJobsList();
        }

        function handleInitialJobDisplay() {
            if (window.innerWidth > 1024 && jobsData.length > 0) {
                const firstJob = createJobDetail(jobsData[0]);
                updateJobDetail(firstJob);
                const firstCard = document.querySelector('.job-card');
                if (firstCard) {
                    firstCard.classList.add('active');
                    currentActiveCard = firstCard;
                }
            }
        }



        //Funciones de crear empleo
        // Función para crear una card de trabajo
        function createJobCard(job) {
            const template = document.getElementById('jobCardTemplate');
            const card = template.content.cloneNode(true);

            // Logo y nombre de la empresa
            const logoImg = card.querySelector('.company-logo img');
            logoImg.src = job.company.logo;
            logoImg.alt = job.company.name;

            card.querySelector('.company-name-text').textContent = job.company.name;

            // Si no está verificada, ocultar el ícono de verificación
            if (!job.company.verified) {
                card.querySelector('.verified-icon').style.display = 'none';
            }

            // Rating y ubicación
            card.querySelector('.rating').textContent = job.company.rating;
            card.querySelector('.location').textContent = job.company.location;

            // Badges
            const badgesContainer = card.querySelector('.badges-container');
            if (!job.featured) {
                badgesContainer.querySelector('.badge-primary').style.display = 'none';
            }
            if (!job.urgent) {
                badgesContainer.querySelector('.badge-urgent').style.display = 'none';
            }

            // Título y detalles
            card.querySelector('.job-title').textContent = job.title;
            card.querySelector('.salary').textContent = job.salary;
            card.querySelector('.contract-type').textContent = job.contractType;

            // Configurar la card completa
            const jobCard = card.querySelector('.job-card');
            jobCard.setAttribute('data-job-id', job.id);

            return jobCard;
        }



        // Funciones de limpieza
        function removeFilter(type) {
            delete selectedFilters[type];

            // Resetear UI del filtro
            const pill = document.querySelector(`.filter-button:contains('${type}')`).closest('.filter-pill');
            const button = pill.querySelector('.filter-button');
            button.childNodes[0].textContent = type;
            pill.querySelectorAll('.dropdown-item').forEach(item => item.classList.remove('selected'));

            applyFilters();
        }

        function closeAllDropdowns() {
            document.querySelectorAll('.filter-pill.active').forEach(pill => {
                pill.classList.remove('active');
                pill.querySelector('.filter-button').setAttribute('aria-expanded', 'false');
            });
        }

        // Iniciar la aplicación
        document.addEventListener('DOMContentLoaded', () => {
            initializeApp();
        });
    </script>
</body>

</html>